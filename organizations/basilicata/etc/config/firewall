config include 'user_fw'
        option path '/etc/firewall.user'

config rule 'Allow_DHCPv6'
	option dest_ip 'fe80::/10'
	option target 'ACCEPT'
	option dest_port '546'
	option src_port '547'
	option name 'Allow-DHCPv6'
	option src_ip 'fe80::/10'
	option family 'ipv6'
	option proto 'udp'
	option src 'wan'

config forwarding 'lan2wan'
	option dest 'wan'
	option src 'lan'

config zone 'lan'
	option network 'lan'
	option output 'ACCEPT'
	option name 'lan'
	option input 'ACCEPT'
	option forward 'ACCEPT'

config rule 'Allow_DHCP_Renew'
	option dest_port '68'
	option name 'Allow-DHCP-Renew'
	option family 'ipv4'
	option target 'ACCEPT'
	option proto 'udp'
	option src 'wan'

config rule 'Allow_ICMPv6_Input'
	option target 'ACCEPT'
	list icmp_type 'destination-unreachable'
	list icmp_type 'time-exceeded'
	list icmp_type 'bad-header'
	list icmp_type 'echo-reply'
	list icmp_type 'neighbour-solicitation'
	list icmp_type 'echo-request'
	list icmp_type 'neighbour-advertisement'
	list icmp_type 'packet-too-big'
	list icmp_type 'router-advertisement'
	list icmp_type 'unknown-header-type'
	list icmp_type 'router-solicitation'
	option name 'Allow-ICMPv6-Input'
	option limit '1000/sec'
	option family 'ipv6'
	option proto 'icmp'
	option src 'wan'

config zone 'ninux'
	option output 'ACCEPT'
	option name 'ninux'
	option input 'ACCEPT'
	option forward 'ACCEPT'
	option network 'ninux vpnbas mesh'

config zone 'wan_wan6'
	option network 'wan wan6'
	option output 'ACCEPT'
	option masq '1'
	option name 'wan'
	option input 'ACCEPT'
	option forward 'REJECT'
	option mtu_fix '1'

config rule 'Allow_Ping'
	option icmp_type 'echo-request'
	option name 'Allow-Ping'
	option target 'ACCEPT'
	option family 'ipv4'
	option proto 'icmp'
	option src 'wan'

config defaults 'SynFlood'
	option syn_flood '1'
	option input 'ACCEPT'
	option forward 'ACCEPT'
	option output 'ACCEPT'

config rule 'Allow_ICMPv6_Forward'
	option target 'ACCEPT'
	option family 'ipv6'
	list icmp_type 'destination-unreachable'
	list icmp_type 'echo-request'
	list icmp_type 'packet-too-big'
	list icmp_type 'unknown-header-type'
	list icmp_type 'time-exceeded'
	list icmp_type 'bad-header'
	list icmp_type 'echo-reply'
	option name 'Allow-ICMPv6-Forward'
	option limit '1000/sec'
	option dest '*'
	option proto 'icmp'
	option src 'wan'

config forwarding 'ninux2wan'
	option dest 'wan'
	option src 'ninux'

config forwarding 'lan2ninux'
	option dest 'ninux'
	option src 'lan'

config forwarding 'ninux2lan'
	option dest 'lan'
	option src 'ninux'

config zone 'hotspot'
	option forward 'ACCEPT'
	option input 'ACCEPT'
	option name 'hotspot'
	option network 'hotspot'
	option output 'ACCEPT'


